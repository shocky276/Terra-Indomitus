chinese_sent_character_to_vassal = {
	on_other_nation = no
	on_own_nation = yes
	close_ui = no
	
	potential_trigger = {
		any_country = {
			is_ai = no
		}
		hidden:scope:target = {
			is_ruler = no
			is_alive = yes
			employer = scope:actor
			is_mercenary = no
			has_culture_group = chinese
			prisoner = no
		}
	}
	
	allowed_trigger = {
		scope:actor = {
			treasury >= 200
		}
		scope:target = {
			has_any_position = no
			is_adult = yes
			is_ruler = no
			prisoner = no
			has_culture_group = chinese
		}
	}
	
	country_target_trigger = {
		in_diplomatic_range = scope:actor
		is_subject = yes
		is_subject_of = scope:actor
		country_culture_group = chinese
		NOT = {
			this = scope:actor
		}
		has_subject_loyalty > 65
	}
	
	effect = {
		if = {
			limit = { exists = scope:recipient }
			scope:actor = {
				add_treasury = -200
			}
			scope:target = {
				move_country = scope:recipient
				employer = {
					save_scope_as = enfeoffment_target
				}
				if = { # spouse effects, notable or unnotable
					limit = { is_married = yes }
						if = {
							limit = {
								spouse = {
									is_alive = yes
									employer = scope:enfeoffment_target
								}
							}
							move_country = scope:recipient
							spouse = { defect_effect = yes }
						}
					else = { 
						divorce_character = spouse
						move_country = scope:recipient
					}
				}
				else = { move_country = scope:recipient } # for tooltip
				if = { # children effects, only unnotable
					limit = {
						num_of_children > 0
						any_child = {
							is_alive = yes
							is_married = no
							employer = scope:enfeoffment_target
						}	
					}
					every_child = {
						limit = {
							is_alive = yes
							is_married = no
							employer = scope:enfeoffment_target
						}
						defect_effect = yes
					}
				}
			}
			scope:recipient = {
				trigger_event = {
					id = aos_replace_the_vassal_ruler.1
				}
			}
		}
	}
}

wac_sent_character_to_vassal = { 
	on_other_nation = no
	on_own_nation = yes
	close_ui = no
	
	potential_trigger = {
		any_country = {
			is_ai = no
		}
		hidden:scope:target = {
			is_ruler = no
			is_alive = yes
			employer = scope:actor
			is_mercenary = no
			prisoner = no
		}
	}
	
	allowed_trigger = {
		scope:actor = {
			treasury >= 500
		}
		scope:target = {
			has_any_position = no
			is_adult = yes
			is_ruler = no
			prisoner = no
		}
	}
	
	country_target_trigger = {
		in_diplomatic_range = scope:actor
		is_subject = yes
		is_subject_of = scope:actor
		NOT = {
			this = scope:actor
		}
		has_subject_loyalty > 75
	}
	
	effect = {
		if = {
			limit = { exists = scope:recipient }
			scope:actor = {
				add_treasury = -500
			}
			scope:target = {
				move_country = scope:recipient
				employer = {
					save_scope_as = enfeoffment_target
				}
				if = { # spouse effects, notable or unnotable
					limit = { is_married = yes }
						if = {
							limit = {
								spouse = {
									is_alive = yes
									employer = scope:enfeoffment_target
								}
							}
							move_country = scope:recipient
							spouse = { defect_effect = yes }
						}
					else = { 
						divorce_character = spouse
						move_country = scope:recipient
					}
				}
				else = { move_country = scope:recipient } # for tooltip
				if = { # children effects, only unnotable
					limit = {
						num_of_children > 0
						any_child = {
							is_alive = yes
							is_married = no
							employer = scope:enfeoffment_target
						}	
					}
					every_child = {
						limit = {
							is_alive = yes
							is_married = no
							employer = scope:enfeoffment_target
						}
						defect_effect = yes
					}
				}
			}
			scope:recipient = {
				trigger_event = {
					id = aos_replace_the_vassal_ruler.1
				}
			}
		}
	}
}

aos_vassal_character_return = {

	on_other_nation = yes
	on_own_nation = no
	
	potential_trigger = {
		hidden:scope:target = {
			is_alive = yes
			NOT = { employer = scope:actor }
			is_mercenary = no
			employer = {
				is_subject = yes
				is_subject_of = scope:actor
			}
		}
	}

	allowed_trigger = {
		hidden:scope:target = {
			is_ruler = no
			is_primary_heir = no
			is_banished = no
			is_governor = no
			is_general = no
			is_admiral = no
			is_pregnant = no
			is_mercenary = no
			prisoner = no
			employer = {
				in_diplomatic_range = scope:actor
				has_subject_loyalty > 60
			}
			trigger_if = {
				limit = {
					OR = {
						from_ruler_family = yes
						has_any_office = yes
						is_head_of_family = yes
						is_party_leader = yes
						is_friend = employer.current_ruler
					}
				}
			}
			trigger_if = {
				limit = {
					is_married = yes
					spouse = {
						employer = scope:target.employer
						is_alive = yes
						is_ruler = yes 
					}
				}
				NOT = { is_friend = spouse }
				OR = { 
					is_rival = spouse
				}
			}
			trigger_if = {
				limit = {
					AND = {
						is_married = yes
						spouse = {
							is_alive = yes
							employer = scope:target.employer
							OR = {
								from_ruler_family = yes
								has_any_office = yes
								is_head_of_family = yes
								is_party_leader = yes
								is_general = yes
								is_admiral = yes
								is_governor = yes
								is_primary_heir = yes
							}
						}
					}
				}
				NOT = { is_friend = spouse }
				OR = { 
					is_rival = spouse
				}
			}
		}
	}
	
	effect = {
		scope:actor = {
			add_political_influence = -5
		}
		scope:target = {
			employer = { # employer upset
				save_scope_as = recruit_employer_scope
				add_opinion = { modifier = recruited_character target = scope:actor }
			}
			if = { # var for employer event desc
				if = {
					limit = {
						is_married = yes
						spouse = { is_ruler = yes }
					}
					set_variable = {
						name = notable_recruit
						value = 1
					}
				}
				else_if = {
					limit = { from_ruler_family = yes }
					set_variable = {
						name = notable_recruit
						value = 2
					}
				}
				else_if = {
					limit = {
						OR = {
							from_ruler_family = yes
							has_any_office = yes
							is_head_of_family = yes
							is_party_leader = yes
						}
					}
					set_variable = {
						name = notable_recruit
						value = 3
					}
				}
				else_if = {
					limit = {
						is_married = yes
						spouse = {
							employer = PREV.employer
							OR = {
								will_defect_unnotable_trigger = yes
								will_defect_notable_trigger = yes
							}
						}
					}
					set_variable = {
						name = notable_recruit
						value = 4
					}
				}
				else = {
					set_variable = {
						name = notable_recruit
						value = 0
					}
				}
			}
			if = { # spouse effects, notable or unnotable
				limit = { is_married = yes }
				if = {
					limit = {
						spouse = {
							is_alive = yes
							employer = scope:recruit_employer_scope
							OR = {
								will_defect_unnotable_trigger = yes
								will_defect_notable_trigger = yes
							}
						}
					}
					move_country = scope:actor
					spouse = { defect_effect = yes }
				}
				else = { 
					divorce_character = spouse
					move_country = scope:actor
				}
			}
			else = { move_country = scope:actor } # for tooltip
			if = { # children effects, only unnotable
				limit = {
					num_of_children > 0
					any_child = {
						is_alive = yes
						is_married = no
						employer = scope:recruit_employer_scope
						will_defect_unnotable_trigger = yes
					}	
				}
				every_child = {
					limit = {
						is_alive = yes
						is_married = no
						employer = scope:recruit_employer_scope
						will_defect_unnotable_trigger = yes
					}
					defect_effect = yes
				}
			}
			hidden_effect = { # personal effects
				remove_character_modifier = foreign_citizen
				set_as_minor_character = THIS
				set_home_country = employer
				if = {
					limit = { has_variable = came_from }
					remove_variable = came_from
				}
			}
		}
	}
}

sent_manpower_to_vassal = {
	on_other_nation = no
	on_own_nation = yes
	close_ui = no
	
	potential_trigger = {
		any_country = {
			is_ai = no
		}
		hidden:scope:target = {
			is_alive = yes
			is_ruler = yes
			is_mercenary = no
			prisoner = no
		}
	}
	
	allowed_trigger = {
		scope:actor = {
			manpower >= 10
		}
	}

	country_target_trigger = {
		in_diplomatic_range = scope:actor
		OR = {
			is_subject_of = scope:actor
			alliance_with = scope:actor
		}
		NOT = {
			this = scope:actor
		}
	}
	
	effect = {
		if = {
			limit = { exists = scope:recipient }
			scope:actor = {
				add_manpower = -10
			}
			scope:recipient = {
				trigger_event = {
					id = sent_manpower_to_vassal.1
				}
			}
		}
	}
}

sent_money_to_vassal = {
	on_other_nation = no
	on_own_nation = yes
	close_ui = no
	
	potential_trigger = {
		any_country = {
			is_ai = no
		}
		hidden:scope:target = {
			is_alive = yes
			is_ruler = yes
			is_mercenary = no
			prisoner = no
		}
	}
	
	allowed_trigger = {
		scope:actor = {
			treasury >= 500
		}
	}

	country_target_trigger = {
		in_diplomatic_range = scope:actor
		OR = {
			is_subject_of = scope:actor
			alliance_with = scope:actor
		}
		NOT = {
			this = scope:actor
		}
	}
	
	effect = {
		if = {
			limit = { exists = scope:recipient }
			scope:actor = {
				add_treasury = -500
			}
			scope:recipient = {
				trigger_event = {
					id = sent_money_to_vassal.1
				}
			}
		}
	}
}

sent_to_vassal = {
	on_other_nation = no
	on_own_nation = yes
	close_ui = no
	
	potential_trigger = {
		any_country = {
			is_ai = no
		}
		hidden:scope:target = {
			is_ruler = no
			is_alive = yes
			employer = scope:actor
			is_mercenary = no
			prisoner = no
		}
	}
	
	allowed_trigger = {
		scope:actor = {
			treasury >= 5
			political_influence >= 3
		}
		scope:target = {
			loyalty >= 55
			is_head_of_family = no
			has_any_position = no
			is_adult = yes
			is_ruler = no
			prisoner = no
		}
	}
	
	country_target_trigger = {
		in_diplomatic_range = scope:actor
		is_subject = yes
		is_subject_of = scope:actor
		NOT = {
			this = scope:actor
		}
		has_subject_loyalty > 50
	}
	
	effect = {
		if = {
			limit = { exists = scope:recipient }
			scope:actor = {
				add_treasury = -5
				add_political_influence = -3
			}
			scope:target = {
				move_country = scope:recipient
				employer = {
					save_scope_as = enfeoffment_target
				}
				if = { # spouse effects, notable or unnotable
					limit = { is_married = yes }
						if = {
							limit = {
								spouse = {
									is_alive = yes
									employer = scope:enfeoffment_target
								}
							}
							move_country = scope:recipient
							spouse = { defect_effect = yes }
						}
					else = { 
						divorce_character = spouse
						move_country = scope:recipient
					}
				}
				else = { move_country = scope:recipient } # for tooltip
				if = { # children effects, only unnotable
					limit = {
						num_of_children > 0
						any_child = {
							is_alive = yes
							is_married = no
							employer = scope:enfeoffment_target
						}	
					}
					every_child = {
						limit = {
							is_alive = yes
							is_married = no
							employer = scope:enfeoffment_target
						}
						defect_effect = yes
					}
				}
			}
		}
	}
}

xueduofengdi = {
	on_other_nation = no
	on_own_nation = yes
	close_ui = no
	
	potential_trigger = {
		hidden:scope:target = {
			is_alive = yes
			is_ruler = yes
			is_mercenary = no
			prisoner = no
			has_culture_group = chinese
		}
		hidden:scope:actor = {
			has_variable = jiaqiangtianwei
		}
	}
	
	allowed_trigger = {
		scope:actor = {
			political_influence >= 10
		}
	}

	country_target_trigger = {
		in_diplomatic_range = scope:actor
		is_subject_of = scope:actor
		country_culture_group = chinese
		has_subject_loyalty > 65
		any_neighbour_country = {
			is_overlord = yes
		}
		NOT = {
			this = scope:actor
		}
	}
	
	effect = {
		if = {
			limit = { exists = scope:recipient }
			scope:actor = {
				add_political_influence = -10
			}
			scope:recipient = {
				trigger_event = {
					id = zhuhouguo_events.3
				}
			}
		}
	}
}

cefengjuewei = {
	on_other_nation = no
	on_own_nation = yes
	close_ui = no
	
	potential_trigger = {
		hidden:scope:target = {
			is_alive = yes
			is_ruler = yes
			is_mercenary = no
			prisoner = no
			has_culture_group = chinese
		}
	}
	
	allowed_trigger = {
		scope:actor = {
			political_influence >= 3
			is_subject = no
			is_overlord = yes
		}
	}

	country_target_trigger = {
		in_diplomatic_range = scope:actor
		is_subject_of = scope:actor
		country_culture_group = chinese
		NOT = {
			this = scope:actor
		}
	}
	
	effect = {
		if = {
			limit = { exists = scope:recipient }
			scope:actor = {
				add_political_influence = -3
				trigger_event = {
					id = zhuhouguo_events.5
				}
			}
		}
	}
}

aos_vassal_false_claim = {

	on_other_nation = yes
	on_own_nation = no
	
	potential_trigger = {
		hidden:scope:target = {
			is_alive = yes
			is_ruler = yes
			NOT = { employer = scope:actor }
			is_mercenary = no
			employer = {
				is_subject = yes
				is_subject_of = scope:actor
			}
		}
		hidden:scope:actor = {
			NOT = {
				has_variable = weizaoxuancheng_zongzhu
			}
		}
	}

	country_target_trigger = {
		any_neighbour_country = {
			this = scope:target.employer
		}
		NOT = {
			this = scope:actor
			is_subject_of = scope:actor
		}
	}
	
	effect = {
		if = {
			limit = { exists = scope:recipient }
			scope:actor = {
				trigger_event = {
					id = weizaoxuancheng_events.1
				}
				set_variable = {
					name = weizaoxuancheng_zongzhu
					days = 366
				}
			}
			scope:recipient = {
				set_variable = {
					name = weizaoxuancheng_linguo
					days = 366
				}
			}
		}
	}
}

chuanbohuaxiawenhua = {
	on_other_nation = no
	on_own_nation = yes
	close_ui = no
	
	potential_trigger = {
		hidden:scope:target = {
			is_alive = yes
			is_ruler = yes
			is_mercenary = no
			prisoner = no
			has_culture_group = chinese
		}
		scope:actor = {
			NOT = {
				has_variable = chuanbohuaxiawenhua_lord
			}
		}
	}
	
	allowed_trigger = {
		scope:actor = {
			political_influence >= 30
			treasury >= 1000
			is_subject = no
			is_overlord = yes
		}
	}

	country_target_trigger = {
		in_diplomatic_range = scope:actor
		is_subject_of = scope:actor
		has_subject_loyalty >= 90
		NOT = {
			this = scope:actor
			country_culture_group = chinese
		}
	}
	
	effect = {
		if = {
			limit = { exists = scope:recipient }
			scope:recipient = {
				set_variable = jieshouhuaxiawenhua_vassal
			}
			scope:actor = {
				trigger_event = {
					id = chuanbohuaxiawenhua_events.1
				}
				set_variable = chuanbohuaxiawenhua_lord
			}
		}
	}
}