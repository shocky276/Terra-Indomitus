namespace = thebes_battle_counting

thebes_battle_counting.1 = {
    type = country_event
    hidden = yes
    trigger = {
        tag = THE
        NOT = { has_variable = stop_counting_idiot }
        scope:actor = { #This is the unit scope
            has_legion_trigger = yes
        }
    }
    immediate = {
        if = {
            limit = {
                NOR = {
                    has_variable = error_log_appeasing_var_3
                    has_variable = legion_battle_counter
                }
            }
            set_variable = error_log_appeasing_var_3
        }
        if = {
            limit = {
                NOT = { has_variable = legion_battle_counter }
            }
            set_variable = {
                name = legion_battle_counter
                value = 1
            }
        }
        else_if = {
            limit = { var:legion_battle_counter < 26 }
            change_variable = {
                name = legion_battle_counter
                add = 1
            }
        }        
    }     
}

namespace = me_thebes

me_thebes.1 = { # Task 1
    type = country_event
    title = me_thebes_1_title
    desc = me_thebes_1_desc
    picture = interesting_histories_hellenic_city_rebuild
    left_portrait = current_ruler

    option = {
        name = me_thebes_1.a
        add_country_modifier = {
            name = building_spree
            duration = 1095
        }
    }
}
me_thebes.2 = { # Task 2
    type = country_event
    title = me_thebes_2_title
    desc = me_thebes_2_desc
    picture = interesting_histories_generic_city_soldiers
    left_portrait = current_ruler

    option = {
        name = me_thebes_2.a
        custom_tooltip = me_thebes_2_tooltip
        add_country_modifier = {
            name = boetian_preparations
            duration = 730
        }
    }
}
me_thebes.3 = { # Task 3
    type = country_event
    title = me_thebes_3_title
    desc = me_thebes_3_desc
    picture = great_work_architect
    left_portrait = current_ruler

    option = {
        name = me_thebes_3.a
        show_as_tooltip = {
            p:426 = {
                add_permanent_province_modifier = {
                    name = fortifications_of_thebes
                }
            }            
        }
    }
}
me_thebes.4 = { # Task 4 - Start
    type = country_event
    title = me_thebes_4_title
    desc = me_thebes_4_desc
    picture = interesting_histories_greek_soldiers
    left_portrait = current_ruler
    right_portrait = scope:hired_mercenary

    immediate = {
        random_character = {
            limit = { is_mercenary = yes}
            save_scope_as = hired_mercenary
        }
    }

    option = {
        name = me_thebes_4.a #Have hired_mercenary prepare for battle with current ruler
        add_country_modifier = {
            name = mercenary_connections
            duration = 3650
        }
    }
}
me_thebes.5 = { # Task 4 - End
    type = country_event
    title = me_thebes_5_title
    desc = me_thebes_5_desc
    picture = interesting_histories_greek_soldiers
    left_portrait = current_ruler
    right_portrait = scope:hired_mercenary

    trigger = {
        exists = scope:hired_mercenary
    }

    immediate = {
        random_unit = {
            limit = {
                commander = scope:hired_mercenary
            }
            save_scope_as = mercenary_army
        }
        current_ruler = { save_scope_as = why_do_i_have_to_do_this }
    }

    option = {
        name = me_thebes_5.a
        custom_tooltip = me_thebes_5_tooltip
        current_ruler = {
            hidden_effect = {
                add_martial = { 1 2 }
                positive_martial_trait_effect = yes
            }
        }
        scope:hired_mercenary = {
            hidden_effect = {
                add_martial = { 1 2 }
                positive_martial_trait_effect = yes
            }
        }
        if = {
            limit = {
                scope:mercenary_army = { exists = yes }
            }
            scope:mercenary_army = {
                add_unit_modifier = {
                    name = boetian_war_prep
                    duration = 730
                }
            }
        }
    }
}
me_thebes.6 = { # Task 5 -  Boetian war
    type = country_event
    title = me_thebes_6_title
    desc = me_thebes_6_desc
    picture = interesting_histories_greek_city_temple
    left_portrait = current_ruler

    option = {
        name = me_thebes_6.a #Boetia will be crushed!!!
        show_as_tooltip = {
            add_country_modifier = {
                name = boetian_struggle
                duration = 730
            }            
        }
    }
}
me_thebes.7 = { # Task 6 - 
    type = country_event
    title = me_thebes_7_title
    desc = me_thebes_7_desc
    picture = interesting_histories_greek_port
    left_portrait = current_ruler

    option = {
        name = me_thebes_7.a #p:468 will prosper!
        show_as_tooltip = {
            p:468 = {
                add_province_modifier = {
                    name = theban_influence 
                    duration = 3650
                }
                capital_formable_small_effect = yes
            }          
        }
    }
}
me_thebes.8 = { # Task 10 - 
    type = country_event
    title = me_thebes_8_title
    desc = me_thebes_8_desc
    picture = interesting_histories_hellenic_dock
    left_portrait = current_ruler
    immediate = {
        show_as_tooltip = {
            capital_scope = {
                capital_formable_small_effect = yes
                formable_capital_modifier_normal_effect = yes
            }
            add_political_influence = influence_large
            add_1_free_province_investments = yes
        }
    }
    option = {
        name = me_thebes_8.a #Thebes will always be our Identity
        add_country_modifier = {
            name = primary_culture_happiness_mod
            duration = 1825
        }
    }
    option = {
        name = me_thebes_8.b #Boeotia League will prosper!
        change_country_name = BOEOTIAN_LEAGUE
        hidden_effect = {
            change_country_adjective = BOEOTIAN_LEAGUE_ADJ
            change_country_color = boeotian_brown
        }
    }
    option = {
        name = me_thebes_8.c #Boeotia will do fine
        change_country_name = BOEOTIAN_NAME
        hidden_effect = {
            change_country_adjective = BOEOTIAN_ADJ
            change_country_color = boeotian_brown
        }
    }
}
me_thebes.9 = { # Task 11 - Pythia
    type = country_event
    title = me_thebes_9_title
    desc = me_thebes_9_desc
    picture = interesting_histories_greek_lady
    left_portrait = current_ruler

    option = {
        name = me_thebes_9.a #Time to visit the Oracle!
        current_ruler = {
            add_gold = -50
        }
        trigger_event = {
            id = me_thebes.10
            days = { 15 30 }
        }
    }   
    option = {
        name = me_thebes_9.b #This is a waste of time
        current_ruler = {
            add_popularity = -5
        }
    }
}
me_thebes.10 = { # Task 6 - 
    type = country_event
    title = me_thebes_10_title
    desc = {
        first_valid = {
            triggered_desc = {  ##Current ruler will lead thebes to greatness
                trigger = { 
                    has_variable = oracle_reading_1
                }   
                desc = "me_thebes_10_desc_1"
            }
            triggered_desc = {  ##Current ruler will lead thebes to destruction
                trigger = { 
                    has_variable = oracle_reading_2
                }   
                desc = "me_thebes_10_desc_2"
            }
            triggered_desc = {  ##Current ruler will die soon
                trigger = { 
                    has_variable = oracle_reading_3
                }   
                desc = "me_thebes_10_desc_3"
            }
            triggered_desc = {  ##Current ruler gains the blood of alexander, somehow
                trigger = { 
                    has_variable = oracle_reading_4
                }   
                desc = "me_thebes_10_desc_4"
            }
        }
    }
    picture = interesting_histories_hellenic_town_man
    left_portrait = current_ruler

    immediate = {
        hidden_effect = {
            random_list = {
                40 = { 
                    set_variable = {
                        name = oracle_reading_1
                        days = 25
                    }
                }
                40 = { 
                    set_variable = {
                        name = oracle_reading_2
                        days = 25
                    }
                }
                10 = { 
                    set_variable = {
                        name = oracle_reading_3
                        days = 25
                    }
                }
                10 = { 
                    set_variable = {
                        name = oracle_reading_4
                        days = 25
                    }
                }
            }
        }
    }

    option = {
        name = me_thebes_10.a #Thebes will Prosper!
        trigger = { has_variable = oracle_reading_1 }
        add_legitimacy = 10
        current_ruler = {
            add_martial = 1
            add_finesse = 1
            add_zeal = 1
        }
    }
    option = {
        name = me_thebes_10.b #Pythia is speaking nonsense...
        trigger = { has_variable = oracle_reading_2 }
        add_legitimacy = -10
    }
    option = {
        name = me_thebes_10.c #Well this isn't good...
        trigger = { has_variable = oracle_reading_3 }
        hidden_effect = {
            current_ruler = {
                add_health = -15
            }
        }
    }
    option = {
        name = me_thebes_10.d #This is Great News!!!
        trigger = { has_variable = oracle_reading_4 }
        current_ruler = {
            force_add_trait = argeads
        }
    }
}
me_thebes.11 = { # Task 12 - Sacred Band
    type = country_event
    title = me_thebes_11_title
    desc = me_thebes_11_desc
    picture = Event_roman_legion_vs_calvary_charge
    left_portrait = current_ruler

    option = {
        name = me_thebes_11.a #They will slay the enemies of Thebes!

    }   
}
me_thebes.12 = { # Task 15 - Destruction of Orchomenos
    type = country_event
    title = me_thebes_12_title
    desc = me_thebes_12_desc
    picture = great_work_riot
    left_portrait = current_ruler

    option = {
        name = me_thebes_12.a #Good Riddance!

    }   
}
####################################################################
#End of First tree events
####################################################################
me_thebes.13 = { # Task 2 - Athenian Rivals Destroyed!
    type = country_event
    title = me_thebes_13_title
    desc = me_thebes_13_desc
    picture = interesting_histories_generic_city_soldiers
    left_portrait = current_ruler

    option = {
        name = me_thebes_13.a #

    }   
}
me_thebes.14 = { # Task 6 - Achaea is ours!
    type = country_event
    title = me_thebes_14_title
    desc = me_thebes_14_desc
    picture = interesting_histories_hellenic_dock
    left_portrait = current_ruler

    option = {
        name = me_thebes_14.a #

    }   
}
me_thebes.15 = { #
    type = country_event
    title = me_thebes_15_title
    desc = me_thebes_15_desc
    picture = looting
    left_portrait = current_ruler
    right_portrait = scope:dick_head

    immediate = {
        scope:target.current_ruler = {
            save_scope_as = dick_head
        }
    }
    option = {
        name = me_thebes_15.a #Send a request for aid

    }   
    option = {
        name = me_thebes_15.b #Send gold with the offer
        add_treasury = -25
    } 
    option = {
        name = me_thebes_15.c #Current_Ruler will go and ask himself
        current_ruler = {
            add_gold = -100
        }
    }
    after = {
        trigger_event = {
            id = me_thebes.16
            days = 30
        }
        set_variable = {
            name = target
            value = scope:target
        }
    }
}
me_thebes.16 = { #Offer accepted
    type = country_event
    title = me_thebes_16_title
    desc = me_thebes_16_desc
    picture = looting
    left_portrait = current_ruler
    right_portrait = scope:dick_head

    option = {
        name = me_thebes_16.a #target.GetName will send troops when war erupts!

    }   
}

me_thebes.17 = { #Offer accepted
    type = country_event
    title = me_thebes_17_title
    desc = me_thebes_17_desc
    picture = looting
    left_portrait = current_ruler
    right_portrait = scope:dick_head

    trigger = {
        NOT = { has_variable = troops_sent }
        tag = THE
        has_variable = target
        war = yes
        any_army = {
            count >= 1
        }
    }

    immediate = {
        set_variable = troops_sent
        #Do this so target stays the same as the previous events
        var:target = {
            save_scope_as = target
        }
        scope:target.current_ruler = {
            save_scope_as = dick_head
        }
        random_army = {
            limit = {
                trigger_if = {
                    limit = {
                        exists = commander
                    }
                    commander = { is_mercenary = no }
                }
            }
            save_scope_as = overlord_army
        }
        random_country = {
            limit = { war_with = ROOT }
            save_scope_as = war_country
        }
    }

    option = {
        name = me_thebes_17.a #
        scope:overlord_army = {
            add_subunit = spearmen
            add_subunit = spearmen
            add_subunit = spearmen
            add_subunit = heavy_infantry
        }
        add_opinion = {
            target = scope:target
            modifier = opinion_gift
        }
    }   
    after = {
        remove_variable = target
    }
}