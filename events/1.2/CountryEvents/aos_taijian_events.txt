namespace = taijian_xiazhaoyu_event
taijian_xiazhaoyu_event.1 = {
	type = country_event
	title = "taijian_xiazhaoyu_event.1.t"
	desc = "taijian_xiazhaoyu_event.1.desc"
	
	picture = china_political
	left_portrait = current_ruler
	right_portrait = scope:target
	
	immediate = {
		hidden_effect = {
			scope:target = {
				add_trial_chance_moderate = yes
			}
		}
	}
	
	option = {
		name = "taijian_xiazhaoyu_event.1.a"
		trigger_event = {
			id = taijian_xiazhaoyu_event.2
		}
	}
	
}


taijian_xiazhaoyu_event.2 = {
	type = country_event
	title = "taijian_xiazhaoyu_event.2.t"
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_local_variable = outcome
					local_var:outcome = 1
				}
				desc = "taijian_xiazhaoyu_event.2.desc_success"
			}
			triggered_desc = {
				trigger = {
					has_local_variable = outcome
					local_var:outcome = 0
				}
				desc = "taijian_xiazhaoyu_event.2.desc_failure"
			}
		}
	}
	
	picture = china_political
	left_portrait = current_ruler
	right_portrait = scope:target
	right_portrait = scope:por_3
	
	immediate = {
		set_local_variable = {
			name = sbgnq1
			value = { integer_range = { min = 1 max = 100 } }
		}
		if = {
			limit = {
				local_var:sbgnq1 <= get_trial_success_chance 
			}
			set_local_variable = {
				name = outcome
				value = 1
			}
		}
		else = {
			set_local_variable = {
				name = outcome
				value = 0
			}
		}
	}
	
	option = {
		name = "taijian_xiazhaoyu_event.2.o_success" 
		trigger = {
			has_local_variable = outcome
			local_var:outcome = 1
		}
		scope:target = {
			remove_all_positions = yes
			root = {
				imprison = {
					target = scope:target
				}
			}
		}
		current_ruler = {
			add_popularity = popularity_medium
		}
	}
	
	option = {
		name = "taijian_xiazhaoyu_event.2.o_failure"
		trigger = {
			has_local_variable = outcome
			local_var:outcome = 0
		}
		current_ruler = {
			add_popularity = subtract_popularity_large
		}
		scope:target = {
			add_popularity = popularity_huge
			hidden_effect = {
				remove_trial_items_effect = yes
			}
		}
		add_stability = -12
		add_tyranny = 8
		trigger_event = {
			id = taijian_xiazhaoyu_event.1
		}
	}
	
	option = {
		name = "taijian_xiazhaoyu_event.2.o_end"
		trigger = {
			has_local_variable = outcome
			local_var:outcome = 0
		}
		add_stability = -5
		add_tyranny = 2
	}
	
}